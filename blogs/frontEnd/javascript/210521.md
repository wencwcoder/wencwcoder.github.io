---
title: JavaScriptä»£ç å°æŠ€å·§
date: 2021-05-21
categories:
 - å‰ç«¯
tags:
 - JavaScript
---

<!-- more -->



## 1. å¦‚ä½•åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å¯è§†åŒºåŸŸ

#### æ–¹æ³•ä¸€

1. é€šè¿‡`document.documentElement.clientHeight`è·å–å±å¹•å¯è§†çª—å£é«˜åº¦
2. é€šè¿‡`element.offsetTop`è·å–å…ƒç´ ç›¸å¯¹äºæ–‡æ¡£é¡¶éƒ¨çš„è·ç¦»
3. é€šè¿‡`document.documentElement.scrollTop`è·å–æµè§ˆå™¨çª—å£é¡¶éƒ¨ä¸æ–‡æ¡£é¡¶éƒ¨ä¹‹é—´çš„è·ç¦»ï¼Œä¹Ÿå°±æ˜¯æ»šåŠ¨æ¡æ»šåŠ¨çš„è·ç¦»

ç„¶ååˆ¤æ–­â‘¡-â‘¢<â‘ æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹ï¼Œå…ƒç´ å°±åœ¨å¯è§†åŒºåŸŸå†…ã€‚



#### æ–¹æ³•äºŒ getBoundingClientRect

é€šè¿‡`getBoundingClientRect()`æ–¹æ³•æ¥è·å–å…ƒç´ çš„å¤§å°ä»¥åŠä½ç½®ã€‚

å‡è®¾`const bound = el.getBoundingClientRect();`æ¥è¡¨ç¤ºå›¾ç‰‡åˆ°å¯è§†åŒºåŸŸé¡¶éƒ¨è·ç¦»ï¼›
å¹¶è®¾ `const clientHeight = window.innerHeight;`æ¥è¡¨ç¤ºå¯è§†åŒºåŸŸçš„é«˜åº¦ã€‚

éšç€æ»šåŠ¨æ¡çš„å‘ä¸‹æ»šåŠ¨ï¼Œ`bound.top`ä¼šè¶Šæ¥è¶Šå°ï¼Œä¹Ÿå°±æ˜¯å›¾ç‰‡åˆ°å¯è§†åŒºåŸŸé¡¶éƒ¨çš„è·ç¦»è¶Šæ¥è¶Šå°ï¼Œå½“`bound.top===clientHeight`æ—¶ï¼Œå›¾ç‰‡çš„ä¸Šæ²¿åº”è¯¥æ˜¯ä½äºå¯è§†åŒºåŸŸä¸‹æ²¿çš„ä½ç½®çš„ä¸´ç•Œç‚¹ï¼Œå†æ»šåŠ¨ä¸€ç‚¹ç‚¹ï¼Œå›¾ç‰‡å°±ä¼šè¿›å…¥å¯è§†åŒºåŸŸã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨`bound.top<=clientHeight`æ—¶ï¼Œå›¾ç‰‡æ˜¯åœ¨å¯è§†åŒºåŸŸå†…çš„ã€‚

```javascript
function isInSight(el) {
  const bound = el.getBoundingClientRect();
  const clientHeight = window.innerHeight;
  //å¦‚æœåªè€ƒè™‘å‘ä¸‹æ»šåŠ¨åŠ è½½
  //const clientWidth = window.innerWeight;
  return bound.top <= clientHeight + 100;
}
```



## 2. å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºç©º

```javascript
const obj = {};

Object.keys(obj).length === 0  // true åˆ™ä¸ºç©ºå¯¹è±¡
Object.keys(obj).length === 0 && obj.constructor === Object
```

ä¸ºä»€ä¹ˆè¿˜è¦é¢å¤–åˆ¤æ–­å¯¹è±¡çš„`constructor`å‘¢ï¼Ÿå³æ„é€ å‡½æ•°å‘¢ï¼Ÿ

åœ¨ JavaScript ä¸­ï¼Œæœ‰9ä¸ªå†…ç½®æ„é€ å‡½æ•°ã€‚

```javascript
new Object();
new String();
new Number();
new Boolean();
new Array();
new RegExp();
new Function();
new Date();
new Error();
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡ï¼Œä¾‹å¦‚ï¼š`new Object()`(æ—¥å¸¸ä¸æ¨èä½¿ç”¨)ã€‚

```javascript
const obj = new Object();

Object.keys(obj).length === 0; // true
```

å¹³å¸¸ä½¿ç”¨çš„åˆ¤æ–­æ–¹æ³•ä¹Ÿæ²¡é—®é¢˜å•ŠğŸ¤”ğŸ¤”ğŸ¤”

ä½†æ˜¯å½“ä½¿ç”¨å‰©ä¸‹çš„å†…ç½®æ„é€ å‡½æ•°åˆ›å»ºå°±ä¼šå‡ºç°é—®é¢˜ã€‚

```javascript
function badEmptyCheck(value) {
    return Object.keys(value).length === 0;
}

badEmptyCheck(new String()); // true
badEmptyCheck(new Number()); // true
badEmptyCheck(new Boolean()); // true
badEmptyCheck(new Array()); // true
badEmptyCheck(new RegExp()); // true
badEmptyCheck(new Function()); // true
badEmptyCheck(new Date()); // true
badEmptyCheck(new Error();); // true
```

æ˜¯ä¸æ˜¯æœ‰ç‚¹æ˜ç™½äº†ï¼Ÿåœ¨æ·»åŠ æ„é€ å‡½æ•°åˆ¤æ–­åï¼š

```javascript
function goodEmptyCheck(value) {
    return Object.keys(value).length === 0 && value.constructor === Object;
}

goodEmptyCheck(new String()); // false
goodEmptyCheck(new Number()); // false
goodEmptyCheck(new Boolean()); // false
goodEmptyCheck(new Array()); // false
goodEmptyCheck(new RegExp()); // false
goodEmptyCheck(new Function()); // false
goodEmptyCheck(new Date()); // false
goodEmptyCheck(new Error();); // false
```

ç»“æœæ­£ç¡®ï¼Œå®é™…ä¸Šæ˜¯æˆ‘ä»¬å¯¹è¾¹ç•Œæƒ…å†µè¿›è¡Œäº†å¤„ç†ã€‚

```javascript
Object.keys(null).length === 0;   // TypeError
Object.keys(undefined).length === 0;  // TypeError
```

æ€»ç»“ï¼š`badEmptyCheck`å’Œ`goodEmptyCheck`ä¸¤ä¸ªæ–¹æ³•çš„åŒºåˆ«ä¸»è¦åœ¨äºæ·»åŠ äº†å¯¹è¾¹ç•Œæƒ…å†µçš„å¤„ç†ï¼Œæ‰€ä»¥åè€…æ›´é€‚ç”¨äºå…¬å…±ç»„ä»¶å’Œä¸€äº›åº“ä¸Šã€‚

```javascript
function goodEmptyCheck(value) {
    return value && Object.keys(value).length === 0 && value.constructor === Object;
}
```



## 3. æ¸…ç©ºå’ŒæˆªçŸ­æ•°ç»„--æ”¹å˜ length å±æ€§

```javascript
const arr = [1,2,3,4,5,6,7,8,9];
arr.length = 5;
console.log(arr); //[1,2,3,4,5]
arr.length = 0; //æ¸…ç©ºæ•°ç»„
```



## 4. æ•°ç»„æ±‚å’Œ

```javascript
var numbers = [3, 5, 7, 2];
var sum = numbers.reduce((x, y) => x + y);
console.log(sum); // returns 17
```



## 5. æ¡ä»¶çŸ­è·¯

```javascript
if (hungry) {
    goToFridge();
}

// è¿›ä¸€æ­¥ç®€åŒ–ä»£ç ï¼ŒåŒæ—¶ä½¿ç”¨å˜é‡å’Œå‡½
hungry && goToFridge()
```



## 6. åŠ¨æ€å±æ€§åç§°

```javascript
const dynamic = 'flavour';
var item = {
    name: 'Coke',
    [dynamic]: 'Cherry'
}
console.log(item); 
// { name: "Coke", flavour: "Cherry" }
```



## 7. ä¸€äº›å±è”½äº‹ä»¶æ“ä½œ

- å½»åº•å±è”½é¼ æ ‡å³é”®

```javascript
oncontextmenu=â€window.event.returnValue=falseâ€
< table border oncontextmenu=return(false)>< td>no< /table> å¯ç”¨äº Table
```

- å–æ¶ˆé€‰å–ã€é˜²æ­¢å¤åˆ¶

```javascript
< body onselectstart=â€return falseâ€>
    
// css
user-select: none;
```

- JS ä¸å…è®¸ç²˜è´´

```javascript
onpaste=â€return falseâ€
```

- JS é˜²æ­¢å¤åˆ¶

```javascript
oncopy=â€return false;â€ oncut=â€return false;â€
```

- ç¦ç”¨è¾“å…¥æ³•

```javascript
< input style=â€ime-mode:disabledâ€>
```

- é˜²æ­¢è¢«äºº frame

```javascript
if (top.location != self.location)top.location=self.location;
```

- ç½‘é¡µç¦ç”¨å¦å­˜ä¸º

```javascript
< no>< iframe src=*.html>< /iframe>< /no>
```



## 8. æ•°ç»„å»é‡

```javascript
// Hash:
function unique(arr = []) {
  if (arr.length === 0 || arr.length === 1) {
    return arr;
  }
  const newArray = [];
  const hash = {};
  for (let i = 0; i < arr.length; i++) {
    if (!hash[arr[i]]) {
      hash[arr[i]] = 1;
      newArray.push(arr[i]);
    }
  }
  return newArray;
}

// Set:
function unique(arr = []) {
  if (arr.length === 0 || arr.length === 1) {
    return arr;
  }
  return [...new Set(arr)];
}
```



## 9. æ–‡ä»¶çš„è¯»å–

```javascript
<input type='file' id='f' />
<div></div>

fileInput.onchange = function() {
    const file = this.files[0];
    const fr = new FileReader();
    fr.readAsText(file);
    fr.onload = function() {
        const result = fr.result;
        // å…¶å®ƒå¤„ç†
        const st = document.createElement('style');
        st.innerHTML = result;
        document.querySelector('head').appendChild(st);
    }
}
```



## 10. ç½‘ç»œçŠ¶æ€æ£€æµ‹

```javascript
const state = window.navigator.onLine; // boolean

window.ononline = function() {
	alert('good');
};
window.onoffline = function() {
    alert('bad');
}
```

