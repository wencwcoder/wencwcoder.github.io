---
title: JavaScriptå®æˆ˜ä»£ç 
date: 2021-05-21
categories:
 - å‰ç«¯
tags:
 - JavaScript
---

<!-- more -->



## 1. å¦‚ä½•åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å¯è§†åŒºåŸŸ

#### æ–¹æ³•ä¸€ï¼š

1. é€šè¿‡`document.documentElement.clientHeight`è·å–å±å¹•å¯è§†çª—å£é«˜åº¦
2. é€šè¿‡`element.offsetTop`è·å–å…ƒç´ ç›¸å¯¹äºæ–‡æ¡£é¡¶éƒ¨çš„è·ç¦»
3. é€šè¿‡`document.documentElement.scrollTop`è·å–æµè§ˆå™¨çª—å£é¡¶éƒ¨ä¸æ–‡æ¡£é¡¶éƒ¨ä¹‹é—´çš„è·ç¦»ï¼Œä¹Ÿå°±æ˜¯æ»šåŠ¨æ¡æ»šåŠ¨çš„è·ç¦»

ç„¶ååˆ¤æ–­â‘¡-â‘¢<â‘ æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹ï¼Œå…ƒç´ å°±åœ¨å¯è§†åŒºåŸŸå†…ã€‚

#### æ–¹æ³•äºŒï¼šgetBoundingClientRect

é€šè¿‡`getBoundingClientRect()`æ–¹æ³•æ¥è·å–å…ƒç´ çš„å¤§å°ä»¥åŠä½ç½®ã€‚

å‡è®¾`const bound = el.getBoundingClientRect();`æ¥è¡¨ç¤ºå›¾ç‰‡åˆ°å¯è§†åŒºåŸŸé¡¶éƒ¨è·ç¦»ï¼›
å¹¶è®¾ `const clientHeight = window.innerHeight;`æ¥è¡¨ç¤ºå¯è§†åŒºåŸŸçš„é«˜åº¦ã€‚

éšç€æ»šåŠ¨æ¡çš„å‘ä¸‹æ»šåŠ¨ï¼Œ`bound.top`ä¼šè¶Šæ¥è¶Šå°ï¼Œä¹Ÿå°±æ˜¯å›¾ç‰‡åˆ°å¯è§†åŒºåŸŸé¡¶éƒ¨çš„è·ç¦»è¶Šæ¥è¶Šå°ï¼Œå½“`bound.top===clientHeight`æ—¶ï¼Œå›¾ç‰‡çš„ä¸Šæ²¿åº”è¯¥æ˜¯ä½äºå¯è§†åŒºåŸŸä¸‹æ²¿çš„ä½ç½®çš„ä¸´ç•Œç‚¹ï¼Œå†æ»šåŠ¨ä¸€ç‚¹ç‚¹ï¼Œå›¾ç‰‡å°±ä¼šè¿›å…¥å¯è§†åŒºåŸŸã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨`bound.top<=clientHeight`æ—¶ï¼Œå›¾ç‰‡æ˜¯åœ¨å¯è§†åŒºåŸŸå†…çš„ã€‚

```javascript
function isInSight(el) {
  const bound = el.getBoundingClientRect();
  const clientHeight = window.innerHeight;
  //å¦‚æœåªè€ƒè™‘å‘ä¸‹æ»šåŠ¨åŠ è½½
  //const clientWidth = window.innerWeight;
  return bound.top <= clientHeight + 100;
}
```



## 2. å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºç©º

```javascript
const obj = {};
Object.keys(obj).length === 0  // true åˆ™ä¸ºç©ºå¯¹è±¡
Object.keys(obj).length === 0 && obj.constructor === Object
```

ä¸ºä»€ä¹ˆè¿˜è¦é¢å¤–åˆ¤æ–­å¯¹è±¡çš„`constructor`å‘¢ï¼Ÿå³æ„é€ å‡½æ•°å‘¢ï¼Ÿ

åœ¨ JavaScript ä¸­ï¼Œæœ‰9ä¸ªå†…ç½®æ„é€ å‡½æ•°ã€‚

```javascript
new Object();
new String();
new Number();
new Boolean();
new Array();
new RegExp();
new Function();
new Date();
new Error();
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ„é€ å‡½æ•°æ¥åˆ›å»ºå¯¹è±¡ï¼Œä¾‹å¦‚ï¼š`new Object()`(æ—¥å¸¸ä¸æ¨èä½¿ç”¨)ã€‚

```javascript
const obj = new Object();
Object.keys(obj).length === 0; // true
```

å¹³å¸¸ä½¿ç”¨çš„åˆ¤æ–­æ–¹æ³•ä¹Ÿæ²¡é—®é¢˜å•ŠğŸ¤”ğŸ¤”ğŸ¤”

ä½†æ˜¯å½“ä½¿ç”¨å‰©ä¸‹çš„å†…ç½®æ„é€ å‡½æ•°åˆ›å»ºå°±ä¼šå‡ºç°é—®é¢˜ã€‚

```javascript
function badEmptyCheck(value) {
    return Object.keys(value).length === 0;
}

badEmptyCheck(new String()); // true
badEmptyCheck(new Number()); // true
badEmptyCheck(new Boolean()); // true
badEmptyCheck(new Array()); // true
badEmptyCheck(new RegExp()); // true
badEmptyCheck(new Function()); // true
badEmptyCheck(new Date()); // true
badEmptyCheck(new Error();); // true
```

æ˜¯ä¸æ˜¯æœ‰ç‚¹æ˜ç™½äº†ï¼Ÿåœ¨æ·»åŠ æ„é€ å‡½æ•°åˆ¤æ–­åï¼š

```javascript
function goodEmptyCheck(value) {
    return Object.keys(value).length === 0 && value.constructor === Object;
}

goodEmptyCheck(new String()); // false
goodEmptyCheck(new Number()); // false
goodEmptyCheck(new Boolean()); // false
goodEmptyCheck(new Array()); // false
goodEmptyCheck(new RegExp()); // false
goodEmptyCheck(new Function()); // false
goodEmptyCheck(new Date()); // false
goodEmptyCheck(new Error();); // false
```

ç»“æœæ­£ç¡®ï¼Œå®é™…ä¸Šæ˜¯æˆ‘ä»¬å¯¹è¾¹ç•Œæƒ…å†µè¿›è¡Œäº†å¤„ç†ã€‚

```javascript
Object.keys(null).length === 0;   // TypeError
Object.keys(undefined).length === 0;  // TypeError
```

æ€»ç»“ï¼š`badEmptyCheck`å’Œ`goodEmptyCheck`ä¸¤ä¸ªæ–¹æ³•çš„åŒºåˆ«ä¸»è¦åœ¨äºæ·»åŠ äº†å¯¹è¾¹ç•Œæƒ…å†µçš„å¤„ç†ï¼Œæ‰€ä»¥åè€…æ›´é€‚ç”¨äºå…¬å…±ç»„ä»¶å’Œä¸€äº›åº“ä¸Šã€‚

```javascript
function goodEmptyCheck(value) {
    return value && Object.keys(value).length === 0 && value.constructor === Object;
}
```



## 3. æ¸…ç©ºå’ŒæˆªçŸ­æ•°ç»„--æ”¹å˜ length å±æ€§

```javascript
const arr = [1,2,3,4,5,6,7,8,9];
arr.length = 5;
console.log(arr); //[1,2,3,4,5]
arr.length = 0; //æ¸…ç©ºæ•°ç»„
```



## 4. æ•°ç»„æ±‚å’Œ

```javascript
var numbers = [3, 5, 7, 2];
var sum = numbers.reduce((x, y) => x + y);
console.log(sum); // 17

// ä¸ä½¿ç”¨å¾ªç¯ï¼Œä¸ä½¿ç”¨æ ‡å‡†åº“çš„å‡½æ•°
function sum (arr, i = 0) {
  function f (i) {
    if (i >= arr.length) {
      return 0;
    }
    return arr[i] + f(i + 1);
  }
  return f(i);
}
```



## 5. æ¡ä»¶çŸ­è·¯

```javascript
if (hungry) {
    goToFridge();
}

// è¿›ä¸€æ­¥ç®€åŒ–ä»£ç ï¼ŒåŒæ—¶ä½¿ç”¨å˜é‡å’Œå‡½
hungry && goToFridge()
```



## 6. åŠ¨æ€å±æ€§åç§°

```javascript
const dynamic = 'flavour';
var item = {
    name: 'Coke',
    [dynamic]: 'Cherry'
}
console.log(item); 
// { name: "Coke", flavour: "Cherry" }
```



## 7. ä¸€äº›å±è”½äº‹ä»¶æ“ä½œ

- å½»åº•å±è”½é¼ æ ‡å³é”®

```javascript
oncontextmenu=â€window.event.returnValue=falseâ€
< table border oncontextmenu=return(false)>< td>no< /table> å¯ç”¨äº Table
```

- å–æ¶ˆé€‰å–ã€é˜²æ­¢å¤åˆ¶

```javascript
< body onselectstart=â€return falseâ€>
    
// css
user-select: none;
```

- JS ä¸å…è®¸ç²˜è´´

```javascript
onpaste=â€return falseâ€
```

- JS é˜²æ­¢å¤åˆ¶

```javascript
oncopy=â€return false;â€ oncut=â€return false;â€
```

- ç¦ç”¨è¾“å…¥æ³•

```javascript
< input style=â€ime-mode:disabledâ€>
```

- é˜²æ­¢è¢«äºº frame

```javascript
if (top.location != self.location)top.location=self.location;
```

- ç½‘é¡µç¦ç”¨å¦å­˜ä¸º

```javascript
< no>< iframe src=*.html>< /iframe>< /no>
```



## 8. æ•°ç»„å»é‡

```javascript
// Hash:
function unique(arr = []) {
  if (arr.length === 0 || arr.length === 1) {
    return arr;
  }
  const newArray = [];
  const hash = {};
  for (let i = 0; i < arr.length; i++) {
    if (!hash[arr[i]]) {
      hash[arr[i]] = 1;
      newArray.push(arr[i]);
    }
  }
  return newArray;
}

// Set:
function unique(arr = []) {
  if (arr.length === 0 || arr.length === 1) {
    return arr;
  }
  return [...new Set(arr)];
}
```



## 9. æ–‡ä»¶çš„è¯»å–

```javascript
<input type='file' id='file' />

document.querySelector('#file').onchange = function(e) {
    // const file = e.target.files[0];
    const file = this.files[0];
    const fr = new FileReader();
    fr.readAsText(file);
    fr.onload = function() {
        const result = fr.result;
        // å…¶å®ƒå¤„ç†
        const st = document.createElement('style');
        st.innerHTML = result;
        document.querySelector('head').appendChild(st);
    }
}

// æ¸…ç©ºï¼Œé˜²æ­¢é€‰æ‹©åŒæ ·çš„æ–‡ä»¶ä¸å†è§¦å‘ change äº‹ä»¶
<input type='file' ref='inputFile' />
this.$refs.inputFile.value = null;
```



## 10. ç½‘ç»œçŠ¶æ€æ£€æµ‹

```javascript
const state = window.navigator.onLine; // boolean

window.ononline = function() {
	alert('good');
};
window.onoffline = function() {
    alert('bad');
}
```



## 11. è¿‡æ»¤ç©ºå€¼

ä½¿ç”¨ `filter()` è¿‡æ»¤ â€œç©ºâ€ å€¼ï¼Œå¦‚ `null`ã€`undefined` æˆ–ç©ºå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨ `.filter(Boolean)` çš„ç¼©å†™æ–¹æ³•ï¼›å®ƒå°†æ‰€æœ‰ç©ºå€¼è½¬ä¸º `false` å¹¶ä»åˆ—è¡¨ä¸­åˆ é™¤å®ƒä»¬ï¼Œä¼˜é›…ï¼

```javascript
const groceries = ['apple', null, 'milk', undefined, 'bread', ''];
const cleanList = groceries.filter(Boolean);
console.log(cleanList); // 'apple', 'milk', 'bread';

filter(Boolean);
filter((item, index) => {
  return Boolean(item);
})

map(parseInt);
map((item, index) => {
  return parseInt(item, index);
})
```



## 12. ç®­å¤´å‡½æ•°ç›´æ¥è¿”å›å¯¹è±¡

ä½¿ç”¨ç®­å¤´å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä¸ºäº†å’Œå‡½æ•°çš„ `{` åŒºåˆ†å¼€æ¥ï¼Œåœ¨å¤–å±‚åŒ…ä¸€å±‚ `(` å³å¯è§£å†³ã€‚

```javascript
const createPerson = (age, name, nationality) => ({
  age,
  name,
  nationality,
});
const caroline = createPerson(27, 'Caroline', 'US');
console.log(caroline);

// {
//   age: 27,
//   name: 'Caroline'
//   nationality: 'US',
// }
```



## 13. æ ¹æ®æ—¶é—´æˆ³è®¡ç®—ç›¸å·®å¤©æ•°

```javascript
function formatTime (value, format) {
    let date = new Date(value);
    let y = date.getFullYear();
    let M = date.getMonth() + 1;
    let d = date.getDate();
    let h = date.getHours();
    let m = date.getMinutes();
    let s = date.getSeconds();
    format = format
        .replace('MM', this.s2d(M))
        .toLowerCase()
        .replace('yyyy', y)
        .replace('yy', y % 100)
        .replace('dd', this.s2d(d))
        .replace('d', d)
        .replace('hh', this.s2d(h))
        .replace('h', h)
        .replace('mm', this.s2d(m))
        .replace('m', m)
        .replace('ss', this.s2d(s))
        .replace('s', s);
    return format;
}

getDateDiff(+new Date(), timestamp)
getDateDiff(from, to) {
    let currentFrom = formatTime(from, 'yyyy-MM-dd');
    let currentTo = formatTime(to, 'yyyy-MM-dd');
    let fromTime = new Date(Date.parse(currentFrom.replace(/-/g, '/'))).getTime();
    let toTime = new Date(Date.parse(currentTo.replace(/-/g, '/'))).getTime();
    let dates = Math.floor((toTime - fromTime)) / (1000 * 60 * 60 * 24);
    return dates + 1;
}
```



## 14. æ·±æ‹·è´--å¾ªç¯é€’å½’

```javascript
function deepClone(obj, hash = new WeakMap()) {
  if (obj === null) return obj; // å¦‚æœæ˜¯nullæˆ–è€…undefinedæˆ‘å°±ä¸è¿›è¡Œæ‹·è´æ“ä½œ
  if (obj instanceof Date) return new Date(obj);
  if (obj instanceof RegExp) return new RegExp(obj);
  // å¯èƒ½æ˜¯å¯¹è±¡æˆ–è€…æ™®é€šçš„å€¼  å¦‚æœæ˜¯å‡½æ•°çš„è¯æ˜¯ä¸éœ€è¦æ·±æ‹·è´
  if (typeof obj !== "object") return obj;
  // æ˜¯å¯¹è±¡çš„è¯å°±è¦è¿›è¡Œæ·±æ‹·è´
  if (hash.get(obj)) return hash.get(obj);
  let cloneObj = new obj.constructor();
  // æ‰¾åˆ°çš„æ˜¯æ‰€å±ç±»åŸå‹ä¸Šçš„constructor,è€ŒåŸå‹ä¸Šçš„ constructoræŒ‡å‘çš„æ˜¯å½“å‰ç±»æœ¬èº«
  hash.set(obj, cloneObj);
  for (let key in obj) {
    if (obj.hasOwnProperty(key)) {
      // å®ç°ä¸€ä¸ªé€’å½’æ‹·è´
      cloneObj[key] = deepClone(obj[key], hash);
    }
  }
  return cloneObj;
}
```



## 15. åˆ†é¡µä¼˜åŒ–

```javascript
// å½“åˆ é™¤å½“å‰é¡µé¢æœ€åä¸€æ¡æ•°æ®çš„æ—¶å€™ï¼Œåº”è¯¥è¯·æ±‚ä¸Šä¸€é¡µçš„æ•°æ®å¹¶å±•ç¤º
// total pageSize currentPage
const totalPage = Math.ceil((this.total - 1) / this.pageSize);
this.currentPage = this.currentPage > totalPage ? totalPage : this.currentPage;
this.currentPage = this.currentPage < 1 ? 1 : this.currentPage;
this.updateInfo();
```



## 16. æ ¼å¼åŒ–æ•°å­—

```javascript
formatNumber(number) {
    const f = new Intl.NumberFormat();
    return f.format(number);
}
```



## 17. æ‰‹å†™å­—ç¬¦ä¸² trim

```javascript
String.prototype.trim = function () {
  return this.replace(/^\s+/, '').replace(/\s+$/, '');
}
```



## 18. æ•°ç»„é“ºå¹³

```javascript
function flat(arr) {
  // éªŒè¯ arr ä¸­ï¼Œè¿˜æœ‰æ²¡æœ‰æ·±å±‚æ•°ç»„ [1, 2, [3, 4]]
  const isDeep = arr.some(item => item instanceof Array)
  if (!isDeep) {
    return arr // å·²ç»æ˜¯ flatern [1, 2, 3, 4]
  }
  const res = Array.prototype.concat.apply([], arr)
  return flat(res) // é€’å½’
}
```



## 19. ç­‰å¾…ä¸€æ®µæ—¶é—´å†æ‰§è¡Œ

```javascript
const wait = async (milliseconds) => new Promise((resolve) => setTimeout(resolve, milliseconds));
```



## 20. è·å–éšæœºå¸ƒå°”å€¼

```javascript
const getRandomBoolean = () => Math.random() >= 0.5
```



## 21. æ£€æµ‹é¼ æ ‡æ˜¯å¦åœ¨æŒ‡å®šå…ƒç´ å†…

```javascript
// å‰ææ˜¯è¦åœ¨é¼ æ ‡è§¦å‘äº‹ä»¶ä¸­æ‰§è¡Œï¼Œ ä¾‹å¦‚ mouseenterã€mouseleaveã€mousemove ç­‰ç­‰
checkIn (_element) {
  // æŒ‡å®šå…ƒç´  / _element
  const ele = document.querySelector('.test');
  // é¼ æ ‡çš„ä½ç½®
  const x = Number(window.event.clientX);
  const y = Number(window.event.clientY);
  // å…ƒç´ çš„ä½ç½®
  const eleX = Number(ele.getBoundingClientRect().left);
  const eleXWidth = Number(ele.getBoundingClientRect().left + ele.clientWidth);
  const eleY = Number(ele.getBoundingClientRect().top);
  const eleXHeight = Number(ele.getBoundingClientRect().top + ele.clientHeight);

  if (x > eleX && x < eleXWidth && y > eleY && y < eleXHeight) {
    return true;
  } else {
    return false;
  }
}
```



## 22. åè¿›åˆ¶è½¬äºŒè¿›åˆ¶

```javascript
var num = 10;

num.toString(2);      // åè¿›åˆ¶è½¬äºŒè¿›åˆ¶
num.toString(8);      // åè¿›åˆ¶è½¬å…«è¿›åˆ¶
num.toString(10);     // åè¿›åˆ¶è½¬åè¿›åˆ¶
num.toString(16);     // åè¿›åˆ¶è½¬åå…­è¿›åˆ¶

parseInt(num, 2);     // äºŒè¿›åˆ¶è½¬åè¿›åˆ¶ï¼›num è¢«çœ‹åšæ˜¯äºŒè¿›åˆ¶çš„æ•°
parseInt(num, 8);     // å…«è¿›åˆ¶è½¬åè¿›åˆ¶ï¼›num è¢«çœ‹åšæ˜¯å…«è¿›åˆ¶çš„æ•°
parseInt(num, 16);    // åå…­è¿›åˆ¶è½¬åè¿›åˆ¶ï¼›num è¢«çœ‹åšæ˜¯åå…­è¿›åˆ¶çš„æ•°

parseInt(num, 2).toString(8);     // äºŒè¿›åˆ¶è½¬å…«è¿›åˆ¶ï¼›ä¹Ÿå¯ä»¥çœ‹åšæ˜¯äºŒè¿›åˆ¶å…ˆè½¬æˆåè¿›åˆ¶ï¼Œå†è½¬æˆå…«è¿›åˆ¶
parseInt(num, 2).toString(16);    // äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶ï¼›ä¹Ÿå¯ä»¥çœ‹åšæ˜¯äºŒè¿›åˆ¶å…ˆè½¬æˆåè¿›åˆ¶ï¼Œå†è½¬æˆåå…­è¿›åˆ¶
```

```javascript
// è‡ªå®šä¹‰å®ç°åè¿›åˆ¶è½¬äºŒè¿›åˆ¶
var numberToBinary = function(num) {
    var result = [];

    if (num < 0) {
        return num;
    }

    // ä½¿ç”¨ do while è§£å†³ num ç­‰äº 0 çš„æƒ…å†µ
    do {
        var temp = num % 2;
        temp == 0 ? result.push('0') : result.push('1');
        num = Math.floor(num / 2);
    } while(num != 0);

    // åè½¬æ•°ç»„
    result.reverse();

    return result.join('');
}
```

